# Chapter1 第一章
**1.某台主频为400MHz的计算机执行标准测试程序，程序中指令类型、执行数量和平均时钟周期数如下：**

指令类型  |	指令执行数量 | 平均时钟周期数
  -|	- | -
整数 |	45000|	1
数据传送	|75000|	2
浮点|	8000	|4
分支|	1500|	2

求该计算机的有效CPI、MIPS和程序执行时间。

## 解答
各类型的指令占比如下：
指令类型  |	占比 | 平均时钟周期数
  -|	-| -
整数 |	0.347|	1
数据传送	|0.579|	2
浮点|	0.062	|4
分支|	0.012|	2

有效CPI是 以上的加权平均：
$$
\begin{aligned}
    \overline{CPI} &= \sum_{i=1}^{n} p_i \times CPI_i  \\
    &= 0.347 \times 1 +  0.579 \times 2 + 0.062 \times 4+ 0.012 \times 2 \\
    &= 1.776  (周期/条)
\end{aligned} 
$$

MIPS是每秒执行多少百万条指令：
$$
\begin{aligned}
    MIPS &= \frac{指令数目}{T_{CPU} \times 10^6 } \\
    &= \frac{主频}{\overline{CPI} \times 10^6 }  \\
    &= \frac{400 \times 10^6Hz}{1.776 \times 10^6 } \\
    &= 225.225 （百万条/秒）
\end{aligned} 
$$

程序执行时间：
$$
    \begin{aligned}
    T_{CPU} &=\frac{指令数目}{MIPS \times 10^6 }  \\
    &= \frac{0.129500 \times 10^6}{225.225 \times 10^6 } \\
    &= 0.000574981 （s） \\
    &= 5.74981 \times 10^{-4}
    \end{aligned} 

$$

**2.将计算机系统中某一功能的处理速度加快10倍，但该功能的处理时间仅为整个系统运行时间的40%，则采用此增强功能方法后，能使整个系统的性能提高多少？**
## 解答
由题，部件加速比Se = 10, 可改进比Fe = 40%
则，加速比
$$
\begin{aligned}
    Sn &= \frac{T_{beforeimproved}}{T_{afterimproved}}\\
    &=\frac{1}{(1 - Fe) + \frac{Fe}{Se}} \\
    &=\frac{1}{(1 - 0.4) + \frac{0.4}{10}} \\
    &=\frac{1}{0.64} = 1.5625
\end{aligned}
$$
即，增加了1.5625倍

**3.计算机系统中有三个部件可以改进，这三个部件的部件加速比为：**
|部件加速比|数值|
|-|-|
$Se_1$|30
$Se_2$|20
$Se_3$|10

1. 如果部件1和部件2的可改进比例均为30%，那么当部件3的可改进比例为多少时，系统加速比才可以达到10？
    1. 用到的公式
$$ 
    Sn = \ \frac{1}{(1 - \sum_{i=1}^{n} Fe_i) + \sum_{i=1}^{n} (\frac{Fe}{Se})_{i}}
$$

设部件三的$Fe_3=x$，Sn = 10
$$
    10 = \ \frac{1}{0.4 - x + 0.01 + 0.015 + \frac{x}{10}}
$$
$$
    4.25 - 9x = 1
$$
$$
   解得： x = 0.36
$$

2. 如果三个部件的可改进比例分别为30%、30%和20%，三个部件同时改进，那么系统中不可加速部分的执行时间在总执行时间中占的比例是多少？

设改进前的时间为 $T_1$

则 $T_1 = T_{0} + 0.8T_1$

未改进部分 $T_{0} = 0.2T_1$

改进后的时间 
$$
T' = \frac{0.3T_1}{30} +  \frac{0.3T_1}{20} +  \frac{0.2T_1}{10} + 0.2T_1 = (0.01 + 0.015 + 0.02 + 0.2)T_1 = 0.245T_1
$$
改进后不可加速部分的执行时间在总执行时间中占的比例:
$$
    比例 = \frac{0.2}{0.245} \times 100\% \approx 82\% 
$$